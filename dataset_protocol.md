# 📊 Bilibili 热门视频预测 —— 数据与标签协议（Week 1）

## 一、任务定义（Task Definition）

本项目旨在构建一个二分类模型，仅使用视频**发布后早期（Δt 小时内）可观测的信息**，
预测该视频是否**曾进入过哔哩哔哩热门榜单**。

本任务**不建模视频进入热门的具体时间**，仅关注“是否进入过热门”这一结果。

---

## 二、标签定义（Label Definition）

每个视频对应一个二分类标签：

- **y = 1（热门视频）**  
  视频曾在任意时间点出现在预先定义的热门榜单中。

- **y = 0（非热门视频）**  
  视频在观察窗口内未出现在热门榜单中。

本项目不依赖视频进入热门的具体时间（enter time），也不要求获取该信息。

---

## 三、热门视频判定标准（Positive Samples）

一个视频被标记为 **y = 1**，需满足以下条件之一：

- 视频的 `bvid` 出现在已收集的热门视频集合中；
- 热门榜单来源在项目中固定（如：全站热门 / 日热门 / 第三方热门榜单）。

一旦视频被标记为热门，即视为正样本，不再区分其上榜顺序或时间。

---

## 四、非热门视频判定标准（Negative Samples）

一个视频被标记为 **y = 0**，需满足以下条件：

- 视频不在热门视频集合中；
- 视频发布后 **T 小时的观察窗口内** 未被记录为热门视频；
- 该视频在数据采集过程中被完整覆盖（非缺失样本）。

为降低时间与内容分布偏差，负样本采用如下构造策略：

- 与正样本发布时间接近（如 ±30 分钟或 ±1 小时）；
- 属于相同或相近分区；
- 按固定比例采样（如 1:5 或 1:10）。

若视频观察窗口未结束或数据不完整，则标记为 `unknown` 并从训练集中剔除。

---

## 五、预测时点与防止信息泄漏（Prediction Time & Leakage Control）

模型仅允许使用视频发布后前 **Δt 小时** 内可获取的信息进行预测。

- 预测窗口：Δt ∈ {1h, 3h, 6h}
- 每个 Δt 视为一个独立的预测设置

### 防止信息泄漏原则

在任何预测设置下，模型**禁止使用**：

- 发布后超过 Δt 时间点才出现的数据；
- 由“进入热门”结果直接或间接触发的统计变化；
- 未来时间段的累计播放量、互动量等指标。

即使相关数据在数据库中存在，也必须在特征构造阶段进行严格截断。

---

## 六、数据结构定义（Data Schema）

### 1️⃣ 视频基础信息表 `video`

| 字段名 | 类型 | 说明 |
|------|------|------|
| bvid | string | 视频唯一标识 |
| pub_time | datetime | 视频发布时间 |
| duration | int | 视频时长（秒） |
| category_id | int | 视频分区 ID |
| category_name | string | 视频分区名称 |
| title | string | 视频标题 |
| tags | string / array | 视频标签 |
| up_mid | string | UP 主 ID |

---

### 2️⃣ 视频早期行为特征表 `video_early_metrics`

（按 Δt 聚合，用于防止时间泄漏）

| 字段名 | 类型 | 说明 |
|------|------|------|
| bvid | string | 视频 ID |
| delta_t | int | 时间窗口（分钟） |
| view_cnt | int | Δt 内播放量 |
| like_cnt | int | Δt 内点赞数 |
| coin_cnt | int | Δt 内投币数 |
| fav_cnt | int | Δt 内收藏数 |
| reply_cnt | int | Δt 内评论数 |
| view_rate | float | 播放增长速率 |
| engagement_ratio | float | 互动 / 播放 比 |

---

### 3️⃣ UP 主信息表 `up_profile`

| 字段名 | 类型 | 说明 |
|------|------|------|
| up_mid | string | UP 主 ID |
| follower_cnt | int | 粉丝数 |
| total_video_cnt | int | 历史投稿数 |
| historical_avg_view | float | 历史平均播放量 |
| historical_popular_cnt | int | 历史热门视频数 |
| account_age_days | int | 账号注册天数 |

---

### 4️⃣ 标签表 `video_label`

| 字段名 | 类型 | 说明 |
|------|------|------|
| bvid | string | 视频 ID |
| label | int | 是否热门（0 / 1） |
| label_source | string | 热门榜单来源 |
| covered_until | datetime | 观察窗口覆盖时间 |

---

## 七、假设与限制（Assumptions & Limitations）

- 本项目仅预测视频是否进入过热门，不预测进入时间或排名；
- 负样本基于观察窗口内未进入热门的视频构造，存在潜在漏标风险；
- 通过时间对齐与分区约束降低采样偏差。

